"use strict";var $=require("jquery"),ko=require("knockout"),sortable=require("jquery-ui/sortable"),draggable=require("jquery-ui/draggable"),console=require("console");if(require("knockout-sortable"),"undefined"==typeof sortable)throw"Cannot find jquery-ui sortable widget dependency!";if("undefined"==typeof draggable)throw"Cannot find jquery-ui sortable widget dependency!";var isDraggingHelper=function(e,t){e()?t.type==e()+"stop"&&e(!1):("dragstart"==t.type||"sortstart"==t.type)&&e(t.type.substring(0,4))},makeExtendedValueAccessor=function(e){return function(){var t=e();ko.utils.peekObservable(t);ko.utils.unwrapObservable(t),"undefined"==t.options&&(t.options={});var r=t.options.start;t.options.start=function(e,i){return"undefined"!=typeof t.dragging&&ko.isWritableObservable(t.dragging)&&isDraggingHelper(t.dragging,e),"undefined"!=typeof t.dropContainer&&(t.scrollInterval=global.setInterval(function(){var e=$(t.dropContainer).scrollTop();$(t.dropContainer).scrollTop(e+t.adding)},20)),"undefined"!=typeof r?r(e,i):void 0};var n=t.options.stop;t.options.stop=function(e,i){return"undefined"!=typeof t.dragging&&ko.isWritableObservable(t.dragging)&&isDraggingHelper(t.dragging,e),"undefined"!=typeof t.dropContainer&&global.clearInterval(t.scrollInterval),"undefined"!=typeof n?n(e,i):void 0};var o=t.options.drag;return t.options.drag=function(e,i){if("undefined"!=typeof t.dropContainer){var r=e.pageY-$(t.dropContainer).offset().top,n=r-$(t.dropContainer).height();-20>r?t.adding=-20:0>r?t.adding=-10:10>r?t.adding=-5:n>20?t.adding=20:n>0?t.adding=10:n>-10?t.adding=5:t.adding=0}return"undefined"!=typeof o?o(e,i):void 0},t}};ko.bindingHandlers.extsortable={init:function(e,t,i,r,n){return ko.bindingHandlers.sortable.init(e,makeExtendedValueAccessor(t),i,r,n)},update:function(e,t,i,r,n){return ko.bindingHandlers.sortable.update(e,makeExtendedValueAccessor(t),i,r,n)}},ko.bindingHandlers.extdraggable={init:function(e,t,i,r,n){return ko.bindingHandlers.draggable.init(e,makeExtendedValueAccessor(t),i,r,n)},update:function(e,t,i,r,n){return ko.bindingHandlers.draggable.update(e,makeExtendedValueAccessor(t),i,r,n)}};