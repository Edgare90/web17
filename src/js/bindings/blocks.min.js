"use strict";var ko=require("knockout"),console=require("console");ko.bindingHandlers.withProperties={init:function(e,t,i,r,n){var o=n.createChildContext(n.$rawData,null,function(e){ko.utils.extend(e,t())});return ko.applyBindingsToDescendants(o,e),{controlsDescendantBindings:!0}}},ko.virtualElements.allowedBindings.withProperties=!0,ko.bindingHandlers.log={init:function(e,t,i,r,n){console.log("log",t())}},ko.bindingHandlers.block={templateExists:function(e){var t=global.document.getElementById(e);return t?!0:!1},_chooseTemplate:function(e,t,i,r){var n=t+"-"+i;if(ko.bindingHandlers.block.templateExists(n))return n;if("undefined"!=typeof r&&null!==r)return ko.bindingHandlers.block._chooseTemplate(e,t,r);var o=e?"array":"object-"+i;if(ko.bindingHandlers.block.templateExists(o))return o;throw"cannot find template for "+n+"/"+o},_displayMode:function(e,t){var i="undefined"!=typeof e.type?ko.utils.unwrapObservable(e.type):"notablock-"+typeof e,r="undefined"!=typeof e.splice,n=t.templateMode?t.templateMode:"show";return ko.bindingHandlers.block._chooseTemplate(r,i,n,t.templateModeFallback)},_makeTemplateValueAccessor:function(e,t){return function(){var n,o,i=e(),r=ko.utils.peekObservable(i);if(!r||"object"!=typeof r.data&&"function"!=typeof r.data)n=i;else if(n=r.data,"undefined"!=typeof r.template){var a=ko.utils.unwrapObservable(r.template),s=t.templateMode?t.templateMode:"show";o=ko.bindingHandlers.block._chooseTemplate(!1,a,s,t.templateModeFallback)}var l=ko.utils.unwrapObservable(n);if(ko.isObservable(l)&&console.log("doubleObservable",l),"undefined"==typeof o)if(void 0===n)o="empty";else try{o=ko.bindingHandlers.block._displayMode(l,t)}catch(d){throw console.log(d,l,t.$data,t.templateMode),d}return{name:o,data:n,templateEngine:ko.nativeTemplateEngine.instance}}},init:function(e,t,i,r,n){"undefined"==typeof t()&&console.log("found a null block: check ending commas in arrays defs in IE");var o=ko.bindingHandlers.block._makeTemplateValueAccessor(t,n);return ko.bindingHandlers.template.init(e,o)},update:function(e,t,i,r,n){var o=ko.bindingHandlers.block._makeTemplateValueAccessor(t,n);return ko.bindingHandlers.template.update(e,o,i,r,n)}},ko.expressionRewriting.bindingRewriteValidators.block=!1,ko.virtualElements.allowedBindings.block=!0;