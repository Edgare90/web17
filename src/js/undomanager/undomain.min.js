"use strict";var ko=require("knockout"),undoManager=require("knockout-undomanager"),undoserializer=require("./undoserializer.js"),addUndoStackExtensionMaker=function(e){return function(t){t.contentListeners(t.contentListeners()+2);var i=undoManager(t.content,{levels:100,undoLabel:ko.computed(function(){return t.t("Undo (#COUNT#)")}),redoLabel:ko.computed(function(){return t.t("Redo")})});return t.undo=i.undoCommand,t.undo.execute=e.bind(t,"undo",t.undo.execute),t.redo=i.redoCommand,t.redo.execute=e.bind(t,"redo",t.redo.execute),t.undoReset=e.bind(t,"undoReset",i.reset),t.setUndoModeMerge=i.setModeMerge,t.setUndoModeOnce=i.setModeOnce,i.setModeIgnore(),i.setUndoActionMaker(undoserializer.makeUndoAction.bind(void 0,t.content)),undoserializer.watchEnabled(!0),{pause:function(){i.setModeIgnore()},run:function(){i.setModeOnce()},init:function(){i.setModeOnce()},dispose:function(){t.contentListeners(t.contentListeners()-2),undoserializer.watchEnabled(!1),i.dispose()}}}};module.exports=addUndoStackExtensionMaker;