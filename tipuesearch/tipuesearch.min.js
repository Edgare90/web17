!function(e){e.fn.tipuesearch=function(t){var r=e.extend({contentLocation:"tipuesearch/tipuesearch_content.json",contextBuffer:60,contextLength:60,contextStart:90,debug:!1,descriptiveWords:25,highlightTerms:!0,liveContent:"*",liveDescription:"*",minimumLength:3,mode:"static",newWindow:!1,show:9,showContext:!0,showRelated:!0,showTime:!0,showTitleCount:!0,showURL:!0,wholeWords:!0},t);return this.each(function(){function n(e){var t=location.search,r=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""],a=r[1].replace(/\+/g,"%20");try{a=decodeURIComponent(a)}catch(i){a=unescape(a)}return a||null}function s(i,n){var v="",l=!1,d=!1,u=!0,p=0;found=[];var m=e("#tipue_search_input").val(),f=m.toLowerCase();f=e.trim(f),(f.match('^"')&&f.match('"$')||f.match("^'")&&f.match("'$"))&&(u=!1);var h=f.split(" ");if(u){f="";for(var b=0;b<h.length;b++){for(var y=!0,g=0;g<tipuesearch_stop_words.length;g++)h[b]==tipuesearch_stop_words[g]&&(y=!1,d=!0);y&&(f=f+" "+h[b])}f=e.trim(f),h=f.split(" ")}else f=f.substring(1,f.length-1);if(f.length>=r.minimumLength){if(u){if(n){for(var w=f,b=0;b<h.length;b++)for(var g=0;g<tipuesearch_replace.words.length;g++)h[b]==tipuesearch_replace.words[g].word&&(f=f.replace(h[b],tipuesearch_replace.words[g].replace_with),l=!0);h=f.split(" ")}for(var x=f,b=0;b<h.length;b++)for(var g=0;g<tipuesearch_stem.words.length;g++)h[b]==tipuesearch_stem.words[g].word&&(x=x+" "+tipuesearch_stem.words[g].stem);h=x.split(" ");for(var b=0;b<t.pages.length;b++){for(var k=0,_=t.pages[b].text,g=0;g<h.length;g++){if(r.wholeWords)var C=new RegExp("\\b"+h[g]+"\\b","gi");else var C=new RegExp(h[g],"gi");if(-1!=t.pages[b].title.search(C)){var E=t.pages[b].title.match(C).length;k+=20*E}if(-1!=t.pages[b].text.search(C)){var E=t.pages[b].text.match(C).length;k+=20*E}if(-1!=t.pages[b].tags.search(C)){var E=t.pages[b].tags.match(C).length;k+=10*E}if(-1!=t.pages[b].url.search(C)&&(k+=20),0!=k)for(var S=0;S<tipuesearch_weight.weight.length;S++)t.pages[b].url==tipuesearch_weight.weight[S].url&&(k+=tipuesearch_weight.weight[S].score);h[g].match("^-")&&(C=new RegExp(h[g].substring(1),"i"),(-1!=t.pages[b].title.search(C)||-1!=t.pages[b].text.search(C)||-1!=t.pages[b].tags.search(C))&&(k=0))}0!=k&&(found.push({score:k,title:t.pages[b].title,desc:_,url:t.pages[b].url}),p++)}}else for(var b=0;b<t.pages.length;b++){var k=0,_=t.pages[b].text,C=new RegExp(f,"gi");if(-1!=t.pages[b].title.search(C)){var E=t.pages[b].title.match(C).length;k+=20*E}if(-1!=t.pages[b].text.search(C)){var E=t.pages[b].text.match(C).length;k+=20*E}if(-1!=t.pages[b].tags.search(C)){var E=t.pages[b].tags.match(C).length;k+=10*E}if(-1!=t.pages[b].url.search(C)&&(k+=20),0!=k)for(var S=0;S<tipuesearch_weight.weight.length;S++)t.pages[b].url==tipuesearch_weight.weight[S].url&&(k+=tipuesearch_weight.weight[S].score);0!=k&&(found.push({score:k,title:t.pages[b].title,desc:_,url:t.pages[b].url}),p++)}if(0!=p){if(r.showTitleCount&&0==a){var D=document.title;document.title="("+p+") "+D,a++}if(l&&(v+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+f+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+w+"</a></div>"),1==p?v+='<div id="tipue_search_results_count">'+tipuesearch_string_4:(c_c=p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),v+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5),r.showTime){var M=(new Date).getTime(),j=(M-startTimer)/1e3;v+=" ("+j.toFixed(2)+" "+tipuesearch_string_14+")",r.showTime=!1}v+="</div>",found.sort(function(e,t){return t.score-e.score});for(var F=0,b=0;b<found.length;b++){if(F>=i&&F<r.show+i){if(v+='<div class="tipue_search_content_title"><a href="'+found[b].url+'"'+o+">"+found[b].title+"</a></div>",r.debug&&(v+='<div class="tipue_search_content_debug">Score: '+found[b].score+"</div>"),r.showURL){var P=found[b].url.toLowerCase();0==P.indexOf("http://")&&(P=P.slice(7)),v+='<div class="tipue_search_content_url"><a href="'+found[b].url+'"'+o+">"+P+"</a></div>"}if(found[b].desc){var T=found[b].desc;if(r.showContext){h=f.split(" ");var $=found[b].desc.toLowerCase().indexOf(h[0]);if($>r.contextStart){var I=T.substr($-r.contextBuffer),z=I.indexOf(" ");I=T.substr($-r.contextBuffer+z),I=e.trim(I),I.length>r.contextLength&&(T="... "+I)}}if(u){h=f.split(" ");for(var g=0;g<h.length;g++)if(r.highlightTerms){var q=new RegExp("("+h[g]+")","gi");T=T.replace(q,'<span class="h0011">$1</span>')}}else if(r.highlightTerms){var q=new RegExp("("+f+")","gi");T=T.replace(q,'<span class="h0011">$1</span>')}var O="",L=T.split(" ");if(L.length<r.descriptiveWords)O=T;else for(var g=0;g<r.descriptiveWords;g++)O+=L[g]+" ";O=e.trim(O),"."!=O.charAt(O.length-1)&&(O+=" ..."),O=O.replace(/h0011/g,"tipue_search_content_bold"),v+='<div class="tipue_search_content_text">'+O+"</div>"}}F++}if(r.showRelated&&u){g=0;for(var b=0;b<tipuesearch_related.searches.length;b++)f==tipuesearch_related.searches[b].search&&(l&&(m=f),g||(v+='<div class="tipue_search_related_title">'+tipuesearch_string_15+' <span class="tipue_search_related_bold">'+m+'</span></div><div class="tipue_search_related_cols">'),v+='<div class="tipue_search_related_text"><a class="tipue_search_related" id="'+tipuesearch_related.searches[b].related+'">',tipuesearch_related.searches[b].before&&(v+='<span class="tipue_search_related_before">'+tipuesearch_related.searches[b].before+"</span> "),v+=tipuesearch_related.searches[b].related,tipuesearch_related.searches[b].after&&(v+=' <span class="tipue_search_related_after">'+tipuesearch_related.searches[b].after+"</span>"),v+="</a></div>",g++);g&&(v+="</div>")}if(p>r.show){var G=Math.ceil(p/r.show),N=i/r.show;if(v+='<nav><div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',i>0&&(v+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="b" id="'+(i-r.show)+"_"+n+'">'+tipuesearch_string_6+"</a></li>"),2>=N){var A=G;G>3&&(A=3);for(var g=0;A>g;g++)v+=g==N?'<li class="current" role="navigation">'+(g+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+g*r.show+"_"+n+'">'+(g+1)+"</a></li>"}else{var A=N+2;A>G&&(A=G);for(var g=N-1;A>g;g++)v+=g==N?'<li class="current" role="navigation">'+(g+1)+"</li>":'<li role="navigation"><a class="tipue_search_foot_box" id="'+g*r.show+"_"+n+'">'+(g+1)+"</a></li>"}N+1!=G&&(v+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="m" id="'+(i+r.show)+"_"+n+'">'+tipuesearch_string_7+"</a></li>"),v+="</ul></div></nav>"}}else v+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else d?v+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(v+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",v+=1==r.minimumLength?'<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":'<div id="tipue_search_warning">'+tipuesearch_string_12+" "+r.minimumLength+" "+tipuesearch_string_13+"</div>");e("#tipue_search_content").hide().html(v).slideDown(200),e("#tipue_search_replaced").click(function(){s(0,!1)}),e(".tipue_search_related").click(function(){e("#tipue_search_input").val(e(this).attr("id")),s(0,!0)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),r=t.split("_");s(parseInt(r[0]),r[1])})}var t={pages:[]};e.ajaxSetup({async:!1});var a=0;if("live"==r.mode)for(var i=0;i<tipuesearch_pages.length;i++)e.get(tipuesearch_pages[i]).done(function(a){var o=e(r.liveContent,a).text();o=o.replace(/\s+/g," ");var n=e(r.liveDescription,a).text();n=n.replace(/\s+/g," ");var s=a.toLowerCase().indexOf("<title>"),v=a.toLowerCase().indexOf("</title>",s+7);if(-1!=s&&-1!=v)var c=a.slice(s+7,v);else var c=tipuesearch_string_1;t.pages.push({title:c,text:n,tags:o,url:tipuesearch_pages[i]})});"json"==r.mode&&e.getJSON(r.contentLocation).done(function(r){t=e.extend({},r)}),"static"==r.mode&&(t=e.extend({},tipuesearch));var o="";r.newWindow&&(o=' target="_blank"'),n("q")&&(e("#tipue_search_input").val(n("q")),s(0,!0)),e(this).keyup(function(e){"13"==e.keyCode&&s(0,!0)})})}}(jQuery);